---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---

### Load packages

```{r}
library(dplyr)
library(ggplot2)
```

### Data

```{r}
setwd("D:\\3rd year\\STAT452")
data <- read.csv("master.csv", header = TRUE)
data
```


### Exploratory Data Analysis

Global suicide rates between genders over year

```{r}
suicide_rates_gender_year <- data %>%
  group_by(year, sex) %>%
  summarise(suicides.100k.pop=sum(suicides_no)*100000 / sum(population))

suicide_gender_year <- data %>%
  group_by(year, sex) %>%
  summarise(suicides_no=sum(suicides_no))
```

Line plot

```{r}
ggplot(data=suicide_rates_gender_year, aes(x=year, y=suicides.100k.pop, group=sex)) +
  geom_line(aes(color=sex)) +
  geom_point(aes(color=sex))

ggplot(data=suicide_gender_year, aes(x=year, y=suicides_no, group=sex)) +
  geom_line(aes(color=sex)) +
  geom_point(aes(color=sex))
```

Global suicide rates between ages over year

```{r}
suicide_rates_ages_year <- data %>%
  group_by(year, age) %>%
  summarise(suicides.100k.pop=sum(suicides_no)*100000 / sum(population))

suicide_ages_year <- data %>%
  group_by(year, age) %>%
  summarise(suicides_no=sum(suicides_no)*100000)
```

Line plot

```{r}
ggplot(data=suicide_rates_ages_year, aes(x=year, y=suicides.100k.pop, group=age)) +
  geom_line(aes(color=age)) +
  geom_point(aes(color=age))

ggplot(data=suicide_ages_year, aes(x=year, y=suicides_no, group=age)) +
  geom_line(aes(color=age)) +
  geom_point(aes(color=age))
```

Global suicide rates between generation over year

```{r}
suicide_rates_generation_year <- data %>%
  group_by(year, generation) %>%
  summarise(suicides.100k.pop=sum(suicides_no)*100000 / sum(population))

suicide_generation_year <- data %>%
  group_by(year, generation) %>%
  summarise(suicides_no=sum(suicides_no))
```

Line plot

```{r}
ggplot(data=suicide_rates_generation_year, aes(x=year, y=suicides.100k.pop, group=generation)) +
  geom_line(aes(color=generation)) +
  geom_point(aes(color=generation))

ggplot(data=suicide_generation_year, aes(x=year, y=suicides_no, group=generation)) +
  geom_line(aes(color=generation)) +
  geom_point(aes(color=generation))
```

Global suicide rates between region over year

```{r}
suicide_rates_region_year <- data %>%
  group_by(year, region) %>%
  summarise(suicides.100k.pop=sum(suicides_no)*100000 / sum(population))

suicide_region_year <- data %>%
  group_by(year, region) %>%
  summarise(suicides_no=sum(suicides_no))
```

Line plot
```{r}
ggplot(data=suicide_rates_region_year, aes(x=year, y=suicides.100k.pop, group=region)) +
  geom_line(aes(color=region)) +
  geom_point(aes(color=region))

ggplot(data=suicide_region_year, aes(x=year, y=suicides_no, group=region)) +
  geom_line(aes(color=region)) +
  geom_point(aes(color=region))
```


Suicide rates between country over year

```{r}
suicide_rates_country_year <- data %>%
  group_by(country, year) %>%
  summarise(suicides.100k.pop=sum(suicides_no)*100000 / sum(population), gdp_per_capita=mean(gdp_per_capita....))
```

Find top 5 country that have highest total suicide rates

```{r}
suicide_rates_country_year_top5 <- suicide_rates_country_year %>%
  group_by(country) %>%
  summarise(total = sum(suicides.100k.pop)) %>%
  arrange(desc(total)) %>%
  slice(1:5)
```


Line plot

```{r}
ggplot(data=filter(suicide_rates_country_year, country %in% suicide_rates_country_year_top5$country), aes(x=year, y=suicides.100k.pop, group=country)) +
  geom_line(aes(color=country)) +
  geom_point(aes(color=country))
```

Relation between suicide rates and gdp per capita by year

```{r}
ggplot(data=filter(suicide_rates_country_year, year == 2010), aes(x=gdp_per_capita, y=suicides.100k.pop, group=year)) +
  geom_point(aes(color=year))
```



